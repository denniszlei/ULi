[supervisord]
nodaemon=true
user=uniload
logfile=/app/logs/supervisord.log
pidfile=/tmp/supervisord.pid
loglevel=info

[program:uni-load-improved]
command=uvicorn app.main:app --host 0.0.0.0 --port 8080 --workers 4
directory=/app/backend
autostart=true
autorestart=true
stdout_logfile=/app/logs/uni-load.log
stderr_logfile=/app/logs/uni-load.error.log
priority=100

[program:gpt-load]
command=bash -c 'if [ "$GPT_LOAD_MODE" = "internal" ]; then gpt-load --config /app/config/gpt-load.yaml --port 3001; else sleep infinity; fi'
autostart=true
autorestart=true
stdout_logfile=/app/logs/gpt-load.log
stderr_logfile=/app/logs/gpt-load.error.log
priority=50

[program:uni-api]
command=bash -c 'if [ "$UNI_API_MODE" = "internal" ]; then uni-api --config /app/config/uni-api.yaml --port 8000; else sleep infinity; fi'
autostart=true
autorestart=true
stdout_logfile=/app/logs/uni-api.log
stderr_logfile=/app/logs/uni-api.error.log
priority=60